[tox]
env_list = unit, lint, e2e
isolated_build = false

[testenv]
passenv =
    BASE_URL
    PIHEALTH_USER
    PIHEALTH_PASSWORD
    PORT
setenv =
    VIRTUALENV_OVERRIDE_APP_DATA={toxworkdir}/.virtualenv
deps =
    -r requirements.txt
    -r tests/requirements.txt

[testenv:unit]
commands =
    pytest tests/ -v -m "not e2e"

[testenv:lint]
deps =
    ruff
commands =
    ruff check --select E9,F63,F7,F82 .

[testenv:e2e]
allowlist_externals =
    playwright
commands =
    pytest -m e2e tests/e2e -v

[testenv:all]
allowlist_externals =
    playwright
    bash
commands =
    ruff check --select E9,F63,F7,F82 .
    pytest tests/ -v -m "not e2e"
    bash scripts/run-e2e.sh
